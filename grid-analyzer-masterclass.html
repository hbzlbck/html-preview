<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Analyzer Masterclass</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #0a0a12;
            --bg-main: #12121c;
            --bg-card: #1a1a28;
            --bg-elevated: #222235;
            --accent-primary: #4ecca3;
            --accent-secondary: #7b68ee;
            --accent-warm: #ff6b6b;
            --accent-gold: #ffd93d;
            --text-primary: #e8e8f0;
            --text-secondary: #9898a8;
            --text-muted: #5a5a70;
            --border-subtle: #2a2a40;
            --code-bg: #0d0d15;
            --gradient-accent: linear-gradient(135deg, #4ecca3 0%, #7b68ee 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'IBM Plex Sans', -apple-system, sans-serif;
            background: var(--bg-deep);
            color: var(--text-primary);
            line-height: 1.7;
            overflow-x: hidden;
        }

        /* Animated background grid */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(78, 204, 163, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(78, 204, 163, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: 0;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(10, 10, 18, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-subtle);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
        }

        .nav-brand {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 1.3rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 8px;
        }

        .nav-link {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            color: var(--text-primary);
            background: var(--bg-elevated);
        }

        .nav-link.active {
            color: var(--accent-primary);
            background: rgba(78, 204, 163, 0.1);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 70px;
            bottom: 0;
            width: 280px;
            background: var(--bg-main);
            border-right: 1px solid var(--border-subtle);
            padding: 30px 20px;
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-muted);
            margin-bottom: 12px;
            padding-left: 12px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            margin-bottom: 4px;
        }

        .sidebar-link:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .sidebar-link.active {
            background: rgba(78, 204, 163, 0.1);
            color: var(--accent-primary);
        }

        .sidebar-link .num {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-muted);
            width: 20px;
        }

        /* Progress bar */
        .progress-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--bg-card);
            z-index: 999;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-accent);
            width: 0%;
            transition: width 0.1s ease;
        }

        /* Main content */
        main {
            margin-left: 280px;
            padding: 100px 60px 80px;
            max-width: 900px;
            position: relative;
            z-index: 1;
        }

        /* Hero section */
        .hero {
            text-align: center;
            padding: 60px 0 80px;
            margin-bottom: 60px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .hero-badge {
            display: inline-block;
            padding: 6px 14px;
            background: rgba(78, 204, 163, 0.1);
            border: 1px solid rgba(78, 204, 163, 0.3);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--accent-primary);
            margin-bottom: 24px;
            font-weight: 500;
        }

        .hero h1 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #fff 0%, #9898a8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Sections */
        .section {
            margin-bottom: 80px;
            scroll-margin-top: 100px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 32px;
        }

        .section-num {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-primary);
            background: rgba(78, 204, 163, 0.1);
            padding: 8px 14px;
            border-radius: 8px;
            font-weight: 600;
        }

        .section h2 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
        }

        .section h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.4rem;
            font-weight: 600;
            margin: 40px 0 20px;
            color: var(--text-primary);
        }

        .section h4 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 30px 0 16px;
            color: var(--accent-secondary);
        }

        .section p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .section ul, .section ol {
            color: var(--text-secondary);
            margin-bottom: 16px;
            padding-left: 24px;
        }

        .section li {
            margin-bottom: 8px;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 28px;
            margin: 24px 0;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .card-icon.green { background: rgba(78, 204, 163, 0.15); }
        .card-icon.purple { background: rgba(123, 104, 238, 0.15); }
        .card-icon.red { background: rgba(255, 107, 107, 0.15); }
        .card-icon.gold { background: rgba(255, 217, 61, 0.15); }

        .card-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Code blocks */
        .code-block {
            position: relative;
            margin: 20px 0;
        }

        .code-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            border-bottom: none;
            border-radius: 12px 12px 0 0;
            padding: 12px 20px;
        }

        .code-lang {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--accent-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .code-copy {
            background: none;
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'IBM Plex Sans', sans-serif;
        }

        .code-copy:hover {
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .code-copy.copied {
            background: rgba(78, 204, 163, 0.2);
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--border-subtle);
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 20px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Inline code */
        p code, li code {
            background: var(--bg-elevated);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            color: var(--accent-primary);
        }

        /* Syntax highlighting */
        .keyword { color: #c792ea; }
        .string { color: #c3e88d; }
        .number { color: #f78c6c; }
        .comment { color: #546e7a; font-style: italic; }
        .function { color: #82aaff; }
        .property { color: #ffcb6b; }
        .tag { color: #ff5572; }
        .attr { color: #ffcb6b; }
        .value { color: #c3e88d; }

        /* Diagram boxes */
        .diagram {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 30px;
            margin: 24px 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            overflow-x: auto;
            white-space: pre;
            color: var(--text-secondary);
        }

        .diagram .highlight {
            color: var(--accent-primary);
        }

        /* Callout boxes */
        .callout {
            border-radius: 12px;
            padding: 20px 24px;
            margin: 24px 0;
            display: flex;
            gap: 16px;
        }

        .callout-icon {
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .callout-content {
            flex: 1;
        }

        .callout-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .callout.tip {
            background: rgba(78, 204, 163, 0.1);
            border: 1px solid rgba(78, 204, 163, 0.2);
        }
        .callout.tip .callout-title { color: var(--accent-primary); }

        .callout.warning {
            background: rgba(255, 217, 61, 0.1);
            border: 1px solid rgba(255, 217, 61, 0.2);
        }
        .callout.warning .callout-title { color: var(--accent-gold); }

        .callout.info {
            background: rgba(123, 104, 238, 0.1);
            border: 1px solid rgba(123, 104, 238, 0.2);
        }
        .callout.info .callout-title { color: var(--accent-secondary); }

        /* Interactive demos */
        .demo-container {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            margin: 24px 0;
        }

        .demo-header {
            background: var(--bg-elevated);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .demo-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .demo-dot.red { background: #ff5f57; }
        .demo-dot.yellow { background: #febc2e; }
        .demo-dot.green { background: #28c840; }

        .demo-title {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-left: 8px;
        }

        .demo-content {
            padding: 24px;
        }

        .demo-preview {
            background: var(--bg-deep);
            border-radius: 8px;
            padding: 24px;
            min-height: 150px;
        }

        /* Collapsible sections */
        .collapsible {
            margin: 16px 0;
        }

        .collapsible-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 16px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s ease;
        }

        .collapsible-header:hover {
            background: var(--bg-elevated);
        }

        .collapsible-header.active {
            border-radius: 10px 10px 0 0;
            border-bottom-color: transparent;
        }

        .collapsible-title {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .collapsible-arrow {
            transition: transform 0.3s ease;
            color: var(--text-muted);
        }

        .collapsible-header.active .collapsible-arrow {
            transform: rotate(180deg);
        }

        .collapsible-content {
            display: none;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-top: none;
            border-radius: 0 0 10px 10px;
            padding: 20px;
        }

        .collapsible-content.show {
            display: block;
        }

        /* Cheat sheet grid */
        .cheat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }

        .cheat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
        }

        .cheat-card h4 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
            margin: 0 0 16px 0;
            color: var(--accent-primary);
        }

        .cheat-card pre {
            margin: 0;
            border-radius: 8px;
            font-size: 0.8rem;
        }

        /* Responsive */
        @media (max-width: 1100px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            main {
                margin-left: 0;
                padding: 100px 30px 60px;
            }

            .nav-links {
                display: none;
            }
        }

        @media (max-width: 600px) {
            .hero h1 {
                font-size: 2.2rem;
            }
            
            nav {
                padding: 0 20px;
            }
        }

        /* Menu toggle */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        @media (max-width: 1100px) {
            .menu-toggle {
                display: block;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-subtle);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    
    <nav>
        <button class="menu-toggle" id="menuToggle">‚ò∞</button>
        <div class="nav-brand">Grid Analyzer Masterclass</div>
        <div class="nav-links">
            <a href="#big-picture" class="nav-link">Overview</a>
            <a href="#html" class="nav-link">HTML</a>
            <a href="#css" class="nav-link">CSS</a>
            <a href="#javascript" class="nav-link">JavaScript</a>
            <a href="#algorithm" class="nav-link">Algorithm</a>
            <a href="#reference" class="nav-link">Reference</a>
        </div>
    </nav>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Fundamentals</div>
            <a href="#big-picture" class="sidebar-link">
                <span class="num">01</span> The Big Picture
            </a>
            <a href="#html" class="sidebar-link">
                <span class="num">02</span> HTML: The Skeleton
            </a>
            <a href="#css" class="sidebar-link">
                <span class="num">03</span> CSS: The Skin
            </a>
            <a href="#javascript" class="sidebar-link">
                <span class="num">04</span> JavaScript: The Brain
            </a>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Deep Dives</div>
            <a href="#algorithm" class="sidebar-link">
                <span class="num">05</span> Image Analysis
            </a>
            <a href="#script-gen" class="sidebar-link">
                <span class="num">06</span> Script Generation
            </a>
            <a href="#debugging" class="sidebar-link">
                <span class="num">07</span> Debugging
            </a>
            <a href="#extending" class="sidebar-link">
                <span class="num">08</span> Extending
            </a>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Quick Reference</div>
            <a href="#reference" class="sidebar-link">
                <span class="num">üìã</span> Cheat Sheets
            </a>
        </div>
    </aside>

    <main>
        <div class="hero">
            <div class="hero-badge">Browser-Based Tool Development</div>
            <h1>Grid Analyzer<br>Masterclass</h1>
            <p>Learn to build browser-based automation tools from scratch. Extract pixel data, analyze images, and generate ExtendScript for After Effects.</p>
        </div>

        <!-- Section 1: Big Picture -->
        <section class="section" id="big-picture">
            <div class="section-header">
                <span class="section-num">01</span>
                <h2>The Big Picture</h2>
            </div>

            <h3>What Are We Actually Building?</h3>
            <p>A <strong>single HTML file</strong> that:</p>
            <ol>
                <li>Accepts an image upload</li>
                <li>Analyzes it for color regions</li>
                <li>Generates an ExtendScript (.jsx) file</li>
                <li>Downloads it automatically</li>
            </ol>

            <div class="callout tip">
                <div class="callout-icon">üí°</div>
                <div class="callout-content">
                    <div class="callout-title">Why a single HTML file?</div>
                    <p>No server needed. Works offline. Just double-click to open. Easy to share with colleagues.</p>
                </div>
            </div>

            <h3>The Mental Model</h3>
            <p>Think of it like After Effects:</p>

            <div class="card">
                <div class="diagram"><span class="highlight">HTML</span>  = Layers (the structure)
<span class="highlight">CSS</span>   = Effects & Styling (how it looks)
<span class="highlight">JS</span>    = Expressions & Scripts (how it behaves)</div>
            </div>

            <h3>The Data Flow</h3>
            <div class="card">
                <div class="diagram">[User drops image]
       ‚Üì
[Image loaded into memory]
       ‚Üì
[Canvas extracts pixel data]
       ‚Üì
[Algorithm finds color regions]
       ‚Üì
[Build shapes array]
       ‚Üì
[Generate .jsx script string]
       ‚Üì
[Trigger download]</div>
            </div>
        </section>

        <!-- Section 2: HTML -->
        <section class="section" id="html">
            <div class="section-header">
                <span class="section-num">02</span>
                <h2>HTML: The Skeleton</h2>
            </div>

            <h3>Basic Structure</h3>
            <p>Every HTML file has this skeleton:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">HTML</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="tag">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attr">lang</span>=<span class="string">"en"</span><span class="tag">&gt;</span>
<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;title&gt;</span>Your Tool Name<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;style&gt;</span>
        <span class="comment">/* CSS goes here */</span>
    <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>
<span class="tag">&lt;body&gt;</span>
    <span class="comment">&lt;!-- Visible content goes here --&gt;</span>
    
    <span class="tag">&lt;script&gt;</span>
        <span class="comment">/* JavaScript goes here */</span>
    <span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre>
            </div>

            <div class="callout info">
                <div class="callout-icon">üì¶</div>
                <div class="callout-content">
                    <div class="callout-title">Why this order?</div>
                    <p><code>&lt;head&gt;</code> loads first (styles ready before content appears). <code>&lt;body&gt;</code> content renders. <code>&lt;script&gt;</code> at the end so HTML is ready when JS runs.</p>
                </div>
            </div>

            <h3>Building the UI Structure</h3>
            <p>Think in <strong>containers</strong> (just like After Effects precomps):</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">HTML</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"container"</span><span class="tag">&gt;</span>           <span class="comment">&lt;!-- Main wrapper --&gt;</span>
    <span class="tag">&lt;h1&gt;</span>Grid Analyzer<span class="tag">&lt;/h1&gt;</span>        <span class="comment">&lt;!-- Title --&gt;</span>
    
    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"main-grid"</span><span class="tag">&gt;</span>       <span class="comment">&lt;!-- Two-column layout --&gt;</span>
        
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"panel"</span><span class="tag">&gt;</span>       <span class="comment">&lt;!-- Left panel --&gt;</span>
            <span class="comment">&lt;!-- Upload area --&gt;</span>
            <span class="comment">&lt;!-- Preview image --&gt;</span>
            <span class="comment">&lt;!-- Analyze button --&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"panel"</span><span class="tag">&gt;</span>       <span class="comment">&lt;!-- Right panel --&gt;</span>
            <span class="comment">&lt;!-- Options/settings --&gt;</span>
            <span class="comment">&lt;!-- Shape list --&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        
    <span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
            </div>

            <h3>Key HTML Elements</h3>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">
                        <span style="color: var(--accent-primary)">1.</span> The Upload Zone
                    </span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">HTML</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"upload-zone"</span> <span class="attr">id</span>=<span class="string">"uploadZone"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>Drop image here or click to upload<span class="tag">&lt;/p&gt;</span>
    <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"fileInput"</span> <span class="attr">accept</span>=<span class="string">"image/*"</span><span class="tag">&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                    </div>
                    <ul>
                        <li><code>id="uploadZone"</code> - So JavaScript can find it</li>
                        <li><code>&lt;input type="file"&gt;</code> - The actual file picker (hidden with CSS)</li>
                        <li><code>accept="image/*"</code> - Only allow image files</li>
                    </ul>
                </div>
            </div>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">
                        <span style="color: var(--accent-primary)">2.</span> Preview Image & Canvas
                    </span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">HTML</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="tag">&lt;img</span> <span class="attr">id</span>=<span class="string">"preview"</span> <span class="attr">alt</span>=<span class="string">"Preview"</span><span class="tag">&gt;</span>
<span class="tag">&lt;canvas</span> <span class="attr">id</span>=<span class="string">"canvas-overlay"</span><span class="tag">&gt;&lt;/canvas&gt;</span></pre>
                    </div>
                    <ul>
                        <li><code>&lt;img&gt;</code> - Shows the uploaded image</li>
                        <li><code>&lt;canvas&gt;</code> - Invisible layer on top for drawing detected shapes</li>
                    </ul>
                </div>
            </div>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">
                        <span style="color: var(--accent-primary)">3.</span> Input Fields & Buttons
                    </span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">HTML</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">id</span>=<span class="string">"compWidth"</span> <span class="attr">value</span>=<span class="string">"1920"</span><span class="tag">&gt;</span>

<span class="tag">&lt;button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"analyzeBtn"</span> <span class="attr">disabled</span><span class="tag">&gt;</span>
    Analyze Grid
<span class="tag">&lt;/button&gt;</span></pre>
                    </div>
                    <ul>
                        <li><code>type="number"</code> - Only allows numbers</li>
                        <li><code>disabled</code> - Grayed out until image is loaded</li>
                        <li><code>id</code> - So JS can enable it later</li>
                    </ul>
                </div>
            </div>

            <h3>The <code>id</code> vs <code>class</code> Distinction</h3>
            
            <div class="card">
                <div class="code-block" style="margin: 0;">
                    <div class="code-header">
                        <span class="code-lang">HTML</span>
                        <button class="code-copy" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><span class="tag">&lt;div</span> <span class="attr">id</span>=<span class="string">"uploadZone"</span> <span class="attr">class</span>=<span class="string">"panel upload-zone"</span><span class="tag">&gt;</span></pre>
                </div>
                <ul style="margin-top: 16px;">
                    <li><strong><code>id</code></strong> = Unique identifier (like a layer name in AE) ‚Äî use for JS targeting</li>
                    <li><strong><code>class</code></strong> = Category (like a label color) ‚Äî use for CSS styling, can repeat</li>
                </ul>
            </div>
        </section>

        <!-- Section 3: CSS -->
        <section class="section" id="css">
            <div class="section-header">
                <span class="section-num">03</span>
                <h2>CSS: The Skin</h2>
            </div>

            <h3>CSS Basics</h3>
            <p>CSS works like this:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">CSS</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="property">selector</span> {
    <span class="property">property</span>: <span class="value">value</span>;
}

<span class="comment">/* Example */</span>
<span class="function">.panel</span> {
    <span class="property">background</span>: <span class="value">#16213e</span>;
    <span class="property">border-radius</span>: <span class="value">12px</span>;
    <span class="property">padding</span>: <span class="value">20px</span>;
}</pre>
            </div>
            <p>This says: "Everything with <code>class="panel"</code> gets these styles"</p>

            <h3>Selectors Cheat Sheet</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">CSS</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="function">.panel</span> { }        <span class="comment">/* Class selector - anything with class="panel" */</span>
<span class="function">#uploadZone</span> { }   <span class="comment">/* ID selector - the one element with id="uploadZone" */</span>
<span class="tag">button</span> { }        <span class="comment">/* Element selector - all &lt;button&gt; elements */</span>
<span class="function">.btn</span><span class="keyword">:hover</span> { }    <span class="comment">/* Pseudo-class - when mouse hovers over .btn */</span>
<span class="function">.btn</span><span class="keyword">:disabled</span> { } <span class="comment">/* Pseudo-class - when button is disabled */</span></pre>
            </div>

            <h3>The Box Model</h3>
            <p>Every element is a box:</p>

            <div class="card">
                <div class="diagram">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           <span class="highlight">MARGIN</span>                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ        <span class="highlight">BORDER</span>             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ      <span class="highlight">PADDING</span>        ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ   <span class="highlight">CONTENT</span>     ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">CSS</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="function">.panel</span> {
    <span class="property">margin</span>: <span class="value">20px</span>;      <span class="comment">/* Space OUTSIDE the border */</span>
    <span class="property">padding</span>: <span class="value">20px</span>;     <span class="comment">/* Space INSIDE the border */</span>
    <span class="property">border</span>: <span class="value">1px solid #ccc</span>;
}</pre>
            </div>

            <h3>Layout with CSS Grid</h3>
            <p>CSS Grid is like a spreadsheet layout:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">CSS</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="function">.main-grid</span> {
    <span class="property">display</span>: <span class="value">grid</span>;
    <span class="property">grid-template-columns</span>: <span class="value">1fr 1fr</span>;  <span class="comment">/* Two equal columns */</span>
    <span class="property">gap</span>: <span class="value">20px</span>;                        <span class="comment">/* Space between cells */</span>
}</pre>
            </div>

            <div class="callout tip">
                <div class="callout-icon">üìê</div>
                <div class="callout-content">
                    <div class="callout-title">Understanding fr units</div>
                    <p><code>1fr</code> = 1 fraction of available space. <code>1fr 1fr</code> = Two equal columns. <code>1fr 2fr</code> = Second column is twice as wide.</p>
                </div>
            </div>

            <h3>Common Patterns</h3>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">üé® Dark Theme Colors</span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">CSS</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="tag">body</span> {
    <span class="property">background</span>: <span class="value">#1a1a2e</span>;    <span class="comment">/* Dark blue-black */</span>
    <span class="property">color</span>: <span class="value">#eee</span>;            <span class="comment">/* Light gray text */</span>
}

<span class="function">.panel</span> {
    <span class="property">background</span>: <span class="value">#16213e</span>;    <span class="comment">/* Slightly lighter */</span>
}

<span class="function">.input</span> {
    <span class="property">background</span>: <span class="value">#0f0f23</span>;    <span class="comment">/* Even darker for inputs */</span>
    <span class="property">border</span>: <span class="value">1px solid #2a2a4a</span>;
}</pre>
                    </div>
                </div>
            </div>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">üì¶ Upload Zone Styling</span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">CSS</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="function">.upload-zone</span> {
    <span class="property">border</span>: <span class="value">2px dashed #4ecca3</span>;   <span class="comment">/* Dashed green border */</span>
    <span class="property">border-radius</span>: <span class="value">8px</span>;
    <span class="property">padding</span>: <span class="value">40px</span>;
    <span class="property">text-align</span>: <span class="value">center</span>;
    <span class="property">cursor</span>: <span class="value">pointer</span>;              <span class="comment">/* Hand cursor on hover */</span>
    <span class="property">transition</span>: <span class="value">all 0.3s</span>;         <span class="comment">/* Smooth animation */</span>
}

<span class="function">.upload-zone</span><span class="keyword">:hover</span> {
    <span class="property">background</span>: <span class="value">rgba(78, 204, 163, 0.1)</span>;  <span class="comment">/* Subtle green tint */</span>
}</pre>
                    </div>
                </div>
            </div>

            <div class="collapsible">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title">üîò Button States</span>
                    <span class="collapsible-arrow">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">CSS</span>
                            <button class="code-copy" onclick="copyCode(this)">Copy</button>
                        </div>
                        <pre><span class="function">.btn-primary</span> {
    <span class="property">background</span>: <span class="value">#4ecca3</span>;
    <span class="property">color</span>: <span class="value">#1a1a2e</span>;
}

<span class="function">.btn-primary</span><span class="keyword">:hover</span> {
    <span class="property">background</span>: <span class="value">#3db892</span>;    <span class="comment">/* Darker on hover */</span>
}

<span class="function">.btn-primary</span><span class="keyword">:disabled</span> {
    <span class="property">background</span>: <span class="value">#2a4a3e</span>;    <span class="comment">/* Muted when disabled */</span>
    <span class="property">color</span>: <span class="value">#666</span>;
    <span class="property">cursor</span>: <span class="value">not-allowed</span>;
}</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: JavaScript -->
        <section class="section" id="javascript">
            <div class="section-header">
                <span class="section-num">04</span>
                <h2>JavaScript: The Brain</h2>
            </div>

            <h3>Variables and State</h3>
            <p>At the top of our script, we declare what we need to track:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// State - what we need to remember</span>
<span class="keyword">let</span> imageData = <span class="keyword">null</span>;        <span class="comment">// Raw pixel data</span>
<span class="keyword">let</span> detectedShapes = [];     <span class="comment">// Array of shape objects</span>
<span class="keyword">let</span> gridLines = { vertical: [], horizontal: [] };</pre>
            </div>

            <div class="callout info">
                <div class="callout-icon">üìù</div>
                <div class="callout-content">
                    <div class="callout-title">let vs const</div>
                    <p><code>let</code> = Can change later. <code>const</code> = Cannot change (use for things you grab once).</p>
                </div>
            </div>

            <h3>Getting References to HTML Elements</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// DOM Elements - grab these once, use many times</span>
<span class="keyword">const</span> uploadZone = document.<span class="function">getElementById</span>(<span class="string">'uploadZone'</span>);
<span class="keyword">const</span> fileInput = document.<span class="function">getElementById</span>(<span class="string">'fileInput'</span>);
<span class="keyword">const</span> preview = document.<span class="function">getElementById</span>(<span class="string">'preview'</span>);
<span class="keyword">const</span> analyzeBtn = document.<span class="function">getElementById</span>(<span class="string">'analyzeBtn'</span>);</pre>
            </div>

            <p><code>document.getElementById('uploadZone')</code> = "Find the element with id='uploadZone'"</p>

            <h3>Event Listeners: Making Things Interactive</h3>
            <p>This is the core of interactivity:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// When user clicks the upload zone, trigger the hidden file input</span>
uploadZone.<span class="function">addEventListener</span>(<span class="string">'click'</span>, () => {
    fileInput.<span class="function">click</span>();
});

<span class="comment">// When user selects a file</span>
fileInput.<span class="function">addEventListener</span>(<span class="string">'change'</span>, (e) => {
    <span class="keyword">if</span> (e.target.files.length) {
        <span class="function">handleFile</span>(e.target.files[<span class="number">0</span>]);
    }
});

<span class="comment">// When user clicks Analyze button</span>
analyzeBtn.<span class="function">addEventListener</span>(<span class="string">'click'</span>, analyzeImage);</pre>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon green">üìñ</div>
                    <div class="card-title">The Pattern</div>
                </div>
                <div class="code-block" style="margin: 0;">
                    <div class="code-header">
                        <span class="code-lang">JavaScript</span>
                        <button class="code-copy" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre>element.<span class="function">addEventListener</span>(<span class="string">'eventType'</span>, functionToRun);</pre>
                </div>
                <p style="margin-top: 16px;"><strong>Common events:</strong> <code>'click'</code>, <code>'change'</code>, <code>'dragover'</code>, <code>'drop'</code></p>
            </div>

            <h3>Drag and Drop</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre>uploadZone.<span class="function">addEventListener</span>(<span class="string">'dragover'</span>, (e) => {
    e.<span class="function">preventDefault</span>();  <span class="comment">// Required! Otherwise browser opens the file</span>
    uploadZone.classList.<span class="function">add</span>(<span class="string">'dragover'</span>);  <span class="comment">// Add visual feedback</span>
});

uploadZone.<span class="function">addEventListener</span>(<span class="string">'dragleave'</span>, () => {
    uploadZone.classList.<span class="function">remove</span>(<span class="string">'dragover'</span>);
});

uploadZone.<span class="function">addEventListener</span>(<span class="string">'drop'</span>, (e) => {
    e.<span class="function">preventDefault</span>();
    uploadZone.classList.<span class="function">remove</span>(<span class="string">'dragover'</span>);
    
    <span class="keyword">if</span> (e.dataTransfer.files.length) {
        <span class="function">handleFile</span>(e.dataTransfer.files[<span class="number">0</span>]);
    }
});</pre>
            </div>

            <div class="callout warning">
                <div class="callout-icon">‚ö†Ô∏è</div>
                <div class="callout-content">
                    <div class="callout-title">Why e.preventDefault()?</div>
                    <p>The browser's default behavior for dropping an image is to open it. We want to intercept that and handle it ourselves.</p>
                </div>
            </div>

            <h3>Loading an Image File</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="keyword">function</span> <span class="function">handleFile</span>(file) {
    <span class="comment">// Validate it's an image</span>
    <span class="keyword">if</span> (!file.type.<span class="function">startsWith</span>(<span class="string">'image/'</span>)) {
        <span class="function">showStatus</span>(<span class="string">'Please upload an image file'</span>, <span class="string">'error'</span>);
        <span class="keyword">return</span>;
    }
    
    <span class="comment">// FileReader converts the file to a data URL</span>
    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="function">FileReader</span>();
    
    <span class="comment">// This runs AFTER the file is read (async!)</span>
    reader.<span class="property">onload</span> = (e) => {
        preview.src = e.target.result;  <span class="comment">// Set image source</span>
        preview.style.display = <span class="string">'block'</span>;
        
        <span class="comment">// This runs AFTER the image loads</span>
        preview.<span class="property">onload</span> = () => {
            <span class="comment">// Now we can access image dimensions</span>
            document.<span class="function">getElementById</span>(<span class="string">'compWidth'</span>).value = preview.naturalWidth;
            document.<span class="function">getElementById</span>(<span class="string">'compHeight'</span>).value = preview.naturalHeight;
            
            analyzeBtn.disabled = <span class="keyword">false</span>;  <span class="comment">// Enable the button</span>
        };
    };
    
    <span class="comment">// Start reading the file (triggers onload when done)</span>
    reader.<span class="function">readAsDataURL</span>(file);
}</pre>
            </div>

            <h4>Understanding Async</h4>
            <div class="card">
                <div class="diagram">reader.<span class="highlight">readAsDataURL</span>(file)  <span class="comment">// Starts reading</span>
         ‚Üì
   [time passes]            <span class="comment">// Reading happens</span>
         ‚Üì
reader.<span class="highlight">onload</span> fires         <span class="comment">// Reading done, NOW we can use it</span>
         ‚Üì
preview.src = result        <span class="comment">// Set the image</span>
         ‚Üì
   [time passes]            <span class="comment">// Image loading</span>
         ‚Üì
preview.<span class="highlight">onload</span> fires        <span class="comment">// Image ready, NOW we can get dimensions</span></div>
            </div>
            <p>This is <strong>asynchronous</strong> ‚Äî the code doesn't wait, it sets up callbacks.</p>
        </section>

        <!-- Section 5: Algorithm -->
        <section class="section" id="algorithm">
            <div class="section-header">
                <span class="section-num">05</span>
                <h2>Image Analysis: The Algorithm</h2>
            </div>

            <p>This is the heart of the tool. Let's break it down.</p>

            <h3>Step 1: Get Pixel Data</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="keyword">function</span> <span class="function">analyzeImage</span>() {
    <span class="comment">// Create an off-screen canvas</span>
    <span class="keyword">const</span> canvas = document.<span class="function">createElement</span>(<span class="string">'canvas'</span>);
    <span class="keyword">const</span> ctx = canvas.<span class="function">getContext</span>(<span class="string">'2d'</span>);
    
    <span class="comment">// Size it to match the image</span>
    canvas.width = preview.naturalWidth;
    canvas.height = preview.naturalHeight;
    
    <span class="comment">// Draw the image onto the canvas</span>
    ctx.<span class="function">drawImage</span>(preview, <span class="number">0</span>, <span class="number">0</span>);
    
    <span class="comment">// Extract raw pixel data</span>
    <span class="keyword">const</span> imgData = ctx.<span class="function">getImageData</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);
    <span class="comment">// imgData.data is a flat array: [R,G,B,A, R,G,B,A, R,G,B,A, ...]</span>
}</pre>
            </div>

            <div class="callout info">
                <div class="callout-icon">üñºÔ∏è</div>
                <div class="callout-content">
                    <div class="callout-title">Why Canvas?</div>
                    <p>You can't read pixel data directly from an <code>&lt;img&gt;</code>. Canvas gives us <code>getImageData()</code> which returns every pixel's RGBA values.</p>
                </div>
            </div>

            <h4>The Pixel Data Structure</h4>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre>imgData.data = [
    R, G, B, A,   <span class="comment">// Pixel 0 (top-left)</span>
    R, G, B, A,   <span class="comment">// Pixel 1</span>
    R, G, B, A,   <span class="comment">// Pixel 2</span>
    ...
]

<span class="comment">// To get pixel at (x, y):</span>
<span class="keyword">const</span> idx = (y * width + x) * <span class="number">4</span>;  <span class="comment">// *4 because RGBA = 4 values</span>
<span class="keyword">const</span> r = data[idx];
<span class="keyword">const</span> g = data[idx + <span class="number">1</span>];
<span class="keyword">const</span> b = data[idx + <span class="number">2</span>];
<span class="keyword">const</span> a = data[idx + <span class="number">3</span>];</pre>
            </div>

            <h3>Step 2: Find Distinct Colors</h3>

            <p>The algorithm:</p>
            <ol>
                <li>Scan pixels (not every pixel ‚Äî that's slow ‚Äî sample every few pixels)</li>
                <li>Group similar colors together (quantize to reduce noise)</li>
                <li>Track the bounding box (min/max X and Y) for each color</li>
            </ol>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// Map to store color regions</span>
<span class="keyword">const</span> colorRegions = <span class="keyword">new</span> <span class="function">Map</span>();

<span class="comment">// Sample every few pixels (faster than checking every one)</span>
<span class="keyword">const</span> step = Math.<span class="function">max</span>(<span class="number">1</span>, Math.<span class="function">floor</span>(Math.<span class="function">min</span>(imgWidth, imgHeight) / <span class="number">300</span>));

<span class="keyword">for</span> (<span class="keyword">let</span> y = <span class="number">0</span>; y < imgHeight; y += step) {
    <span class="keyword">for</span> (<span class="keyword">let</span> x = <span class="number">0</span>; x < imgWidth; x += step) {
        <span class="comment">// Get pixel color</span>
        <span class="keyword">const</span> idx = (y * imgWidth + x) * <span class="number">4</span>;
        <span class="keyword">const</span> r = data[idx];
        <span class="keyword">const</span> g = data[idx + <span class="number">1</span>];
        <span class="keyword">const</span> b = data[idx + <span class="number">2</span>];
        
        <span class="comment">// Quantize: round to nearest 16 to group similar colors</span>
        <span class="keyword">const</span> qr = Math.<span class="function">round</span>(r / <span class="number">16</span>) * <span class="number">16</span>;
        <span class="keyword">const</span> qg = Math.<span class="function">round</span>(g / <span class="number">16</span>) * <span class="number">16</span>;
        <span class="keyword">const</span> qb = Math.<span class="function">round</span>(b / <span class="number">16</span>) * <span class="number">16</span>;
        <span class="keyword">const</span> colorKey = <span class="string">`</span>${qr}<span class="string">,</span>${qg}<span class="string">,</span>${qb}<span class="string">`</span>;
        
        <span class="comment">// First time seeing this color?</span>
        <span class="keyword">if</span> (!colorRegions.<span class="function">has</span>(colorKey)) {
            colorRegions.<span class="function">set</span>(colorKey, {
                minX: x, maxX: x,
                minY: y, maxY: y,
                r: r, g: g, b: b,
                pixelCount: <span class="number">0</span>
            });
        }
        
        <span class="comment">// Update bounding box</span>
        <span class="keyword">const</span> region = colorRegions.<span class="function">get</span>(colorKey);
        <span class="keyword">if</span> (x < region.minX) region.minX = x;
        <span class="keyword">if</span> (x > region.maxX) region.maxX = x;
        <span class="keyword">if</span> (y < region.minY) region.minY = y;
        <span class="keyword">if</span> (y > region.maxY) region.maxY = y;
        region.pixelCount++;
    }
}</pre>
            </div>

            <div class="callout tip">
                <div class="callout-icon">üé®</div>
                <div class="callout-content">
                    <div class="callout-title">Why Quantize Colors?</div>
                    <p>Real images have subtle variations. A "solid red" might actually be <code>rgb(255,0,0)</code>, <code>rgb(254,1,0)</code>, <code>rgb(255,0,1)</code>. By rounding to nearest 16, these all become <code>rgb(256,0,0)</code> and get grouped together.</p>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">‚ö°</div>
                <div class="callout-content">
                    <div class="callout-title">Why Sample Instead of Every Pixel?</div>
                    <p>A 1920√ó1080 image = 2,073,600 pixels. Checking every one is slow. Sampling every 3-5 pixels gives you the same shapes but much faster.</p>
                </div>
            </div>

            <h3>Step 3: Filter and Sort</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// Convert to shapes array</span>
<span class="keyword">const</span> shapes = [];
<span class="keyword">const</span> minArea = imgWidth * imgHeight * <span class="number">0.01</span>;  <span class="comment">// At least 1% of image</span>

<span class="keyword">for</span> (<span class="keyword">const</span> [colorKey, region] <span class="keyword">of</span> colorRegions) {
    <span class="keyword">const</span> width = region.maxX - region.minX;
    <span class="keyword">const</span> height = region.maxY - region.minY;
    <span class="keyword">const</span> area = width * height;
    
    <span class="comment">// Skip tiny regions (noise)</span>
    <span class="keyword">if</span> (area < minArea) <span class="keyword">continue</span>;
    
    shapes.<span class="function">push</span>({
        left: region.minX / imgWidth,    <span class="comment">// Convert to 0-1 proportion</span>
        right: region.maxX / imgWidth,
        top: region.minY / imgHeight,
        bottom: region.maxY / imgHeight,
        color: [region.r / <span class="number">255</span>, region.g / <span class="number">255</span>, region.b / <span class="number">255</span>]  <span class="comment">// 0-1 for AE</span>
    });
}

<span class="comment">// Sort top-to-bottom, left-to-right</span>
shapes.<span class="function">sort</span>((a, b) => {
    <span class="keyword">const</span> rowA = Math.<span class="function">floor</span>(a.top * <span class="number">10</span>);
    <span class="keyword">const</span> rowB = Math.<span class="function">floor</span>(b.top * <span class="number">10</span>);
    <span class="keyword">if</span> (rowA !== rowB) <span class="keyword">return</span> rowA - rowB;
    <span class="keyword">return</span> a.left - b.left;
});

<span class="comment">// Number them</span>
shapes.<span class="function">forEach</span>((shape, i) => {
    shape.num = (i + <span class="number">1</span>).<span class="function">toString</span>().<span class="function">padStart</span>(<span class="number">2</span>, <span class="string">'0'</span>);  <span class="comment">// "01", "02", etc.</span>
    shape.name = <span class="string">`Shape_</span>${shape.num}<span class="string">`</span>;
});</pre>
            </div>
        </section>

        <!-- Section 6: Script Generation -->
        <section class="section" id="script-gen">
            <div class="section-header">
                <span class="section-num">06</span>
                <h2>Script Generation: The Output</h2>
            </div>

            <h3>Building a String of Code</h3>
            <p>We need to generate ExtendScript code as a string:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="keyword">function</span> <span class="function">generateScript</span>() {
    <span class="keyword">const</span> compWidth = <span class="function">parseInt</span>(document.<span class="function">getElementById</span>(<span class="string">'compWidth'</span>).value);
    <span class="keyword">const</span> compHeight = <span class="function">parseInt</span>(document.<span class="function">getElementById</span>(<span class="string">'compHeight'</span>).value);
    
    <span class="comment">// Build the rectangles array as a string</span>
    <span class="keyword">let</span> rectArrayStr = <span class="string">''</span>;
    detectedShapes.<span class="function">forEach</span>((shape, i) => {
        rectArrayStr += <span class="string">`            { 
            name: "</span>${shape.num}<span class="string">_Shape",
            left: </span>${shape.left.<span class="function">toFixed</span>(<span class="number">4</span>)}<span class="string">, 
            right: </span>${shape.right.<span class="function">toFixed</span>(<span class="number">4</span>)}<span class="string">,
            top: </span>${shape.top.<span class="function">toFixed</span>(<span class="number">4</span>)}<span class="string">, 
            bottom: </span>${shape.bottom.<span class="function">toFixed</span>(<span class="number">4</span>)}<span class="string">,
            color: [</span>${shape.color[<span class="number">0</span>].<span class="function">toFixed</span>(<span class="number">3</span>)}<span class="string">, </span>${shape.color[<span class="number">1</span>].<span class="function">toFixed</span>(<span class="number">3</span>)}<span class="string">, </span>${shape.color[<span class="number">2</span>].<span class="function">toFixed</span>(<span class="number">3</span>)}<span class="string">]
        }</span>${i < detectedShapes.length - <span class="number">1</span> ? <span class="string">','</span> : <span class="string">''</span>}<span class="string">\n`</span>;
    });
    
    <span class="comment">// The full script as a template literal</span>
    <span class="keyword">const</span> script = <span class="string">`// After Effects Script
(function() {
    var comp = app.project.activeItem;
    
    var rectangles = [
</span>${rectArrayStr}<span class="string">
    ];
    
    // ... rest of the script ...
})();
`</span>;
    
    <span class="keyword">return</span> script;
}</pre>
            </div>

            <div class="callout info">
                <div class="callout-icon">üìù</div>
                <div class="callout-content">
                    <div class="callout-title">Template Literals (backticks)</div>
                    <p><code>const greeting = `Hello, ${name}!`</code> ‚Äî The <code>${...}</code> lets you embed variables and expressions. Backticks also allow multi-line strings.</p>
                </div>
            </div>

            <h3>Triggering a Download</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="keyword">function</span> <span class="function">downloadScript</span>(scriptContent, filename) {
    <span class="comment">// Create a Blob (binary large object) from the text</span>
    <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="function">Blob</span>([scriptContent], { type: <span class="string">'text/plain'</span> });
    
    <span class="comment">// Create a temporary URL pointing to the blob</span>
    <span class="keyword">const</span> url = URL.<span class="function">createObjectURL</span>(blob);
    
    <span class="comment">// Create a hidden &lt;a&gt; element</span>
    <span class="keyword">const</span> a = document.<span class="function">createElement</span>(<span class="string">'a'</span>);
    a.href = url;
    a.download = filename;  <span class="comment">// This attribute triggers download vs navigate</span>
    
    <span class="comment">// Add to page, click it, remove it</span>
    document.body.<span class="function">appendChild</span>(a);
    a.<span class="function">click</span>();
    document.body.<span class="function">removeChild</span>(a);
    
    <span class="comment">// Clean up the blob URL</span>
    URL.<span class="function">revokeObjectURL</span>(url);
}</pre>
            </div>

            <div class="callout tip">
                <div class="callout-icon">üí°</div>
                <div class="callout-content">
                    <div class="callout-title">The Trick</div>
                    <p>The <code>download</code> attribute on an <code>&lt;a&gt;</code> tag tells the browser "download this file instead of navigating to it."</p>
                </div>
            </div>

            <h3>The Generated ExtendScript Structure</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript (ExtendScript)</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre>(<span class="keyword">function</span>() {
    <span class="comment">// 1. Validate we have a comp</span>
    <span class="keyword">var</span> comp = app.project.activeItem;
    <span class="keyword">if</span> (!comp || !(comp <span class="keyword">instanceof</span> CompItem)) {
        <span class="function">alert</span>(<span class="string">"Please select a composition first."</span>);
        <span class="keyword">return</span>;
    }
    
    <span class="comment">// 2. Wrap in undo group</span>
    app.<span class="function">beginUndoGroup</span>(<span class="string">"Create Grid Layout"</span>);
    
    <span class="keyword">try</span> {
        <span class="comment">// 3. Define the shapes data</span>
        <span class="keyword">var</span> rectangles = [ <span class="comment">/* ... */</span> ];
        
        <span class="comment">// 4. Create each shape</span>
        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i < rectangles.length; i++) {
            <span class="function">createGridShape</span>(comp, rectangles[i], <span class="comment">/* ... */</span>);
        }
        
        <span class="comment">// 5. Success message</span>
        <span class="function">alert</span>(<span class="string">"Done!"</span>);
        
    } <span class="keyword">catch</span> (err) {
        <span class="function">alert</span>(<span class="string">"Error: "</span> + err.<span class="function">toString</span>());
    }
    
    app.<span class="function">endUndoGroup</span>();
})();

<span class="keyword">function</span> <span class="function">createGridShape</span>(comp, rect, <span class="comment">/* ... */</span>) {
    <span class="comment">// Create layers, set properties, apply expressions</span>
}</pre>
            </div>

            <div class="callout info">
                <div class="callout-icon">üîÑ</div>
                <div class="callout-content">
                    <div class="callout-title">Why the IIFE (function() { ... })();?</div>
                    <p><strong>Immediately Invoked Function Expression</strong> ‚Äî Keeps variables local (doesn't pollute global scope). Standard pattern for AE scripts.</p>
                </div>
            </div>
        </section>

        <!-- Section 7: Debugging -->
        <section class="section" id="debugging">
            <div class="section-header">
                <span class="section-num">07</span>
                <h2>Debugging Strategies</h2>
            </div>

            <h3>Console Logging</h3>
            <p>Your best friend for debugging:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre>console.<span class="function">log</span>(<span class="string">"Shape detected:"</span>, shape);
console.<span class="function">log</span>(<span class="string">"Width:"</span>, width, <span class="string">"Height:"</span>, height);

<span class="comment">// Log the whole state at a certain point</span>
console.<span class="function">log</span>({
    imageWidth: preview.naturalWidth,
    imageHeight: preview.naturalHeight,
    shapesFound: detectedShapes.length,
    shapes: detectedShapes
});</pre>
            </div>

            <p>Open browser DevTools (<code>F12</code> or <code>Cmd+Option+I</code>) to see the console.</p>

            <h3>Visual Debugging</h3>
            <p>Draw on the canvas to see what's happening:</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JavaScript</span>
                    <button class="code-copy" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><span class="comment">// Draw a red dot at each detected corner</span>
ctx.fillStyle = <span class="string">'red'</span>;
shapes.<span class="function">forEach</span>(shape => {
    ctx.<span class="function">beginPath</span>();
    ctx.<span class="function">arc</span>(shape.left * width, shape.top * height, <span class="number">5</span>, <span class="number">0</span>, Math.PI * <span class="number">2</span>);
    ctx.<span class="function">fill</span>();
});</pre>
            </div>

            <h3>Common Issues and Fixes</h3>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon red">üî¥</div>
                    <div class="card-title">"Nothing happens when I click"</div>
                </div>
                <ul>
                    <li>Check the browser console for errors</li>
                    <li>Make sure the element ID matches exactly</li>
                    <li>Verify the event listener is attached</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon gold">üü°</div>
                    <div class="card-title">"Image won't load"</div>
                </div>
                <ul>
                    <li>Check if it's a CORS issue (can't load images from other domains)</li>
                    <li>For local files, some browsers block file:// access</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon purple">üü£</div>
                    <div class="card-title">"Shapes are in wrong position"</div>
                </div>
                <ul>
                    <li>Log the coordinates at each step</li>
                    <li>Check if you're mixing up proportions (0-1) vs pixels</li>
                    <li>Verify comp dimensions match</li>
                </ul>
            </div>
        </section>

        <!-- Section 8: Extending -->
        <section class="section" id="extending">
            <div class="section-header">
                <span class="section-num">08</span>
                <h2>How to Extend This</h2>
            </div>

            <h3>Adding a New Option</h3>

            <div class="card">
                <p><strong>Step 1:</strong> Add HTML input</p>
                <div class="code-block" style="margin-bottom: 16px;">
                    <div class="code-header">
                        <span class="code-lang">HTML</span>
                        <button class="code-copy" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"option-group"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;label&gt;</span>Stroke Width<span class="tag">&lt;/label&gt;</span>
    <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">id</span>=<span class="string">"strokeWidth"</span> <span class="attr">value</span>=<span class="string">"2"</span><span class="tag">&gt;</span>
<span class="tag">&lt;/div&gt;</span></pre>
                </div>

                <p><strong>Step 2:</strong> Read it in JavaScript</p>
                <div class="code-block" style="margin-bottom: 16px;">
                    <div class="code-header">
                        <span class="code-lang">JavaScript</span>
                        <button class="code-copy" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><span class="keyword">const</span> strokeWidth = <span class="function">parseInt</span>(document.<span class="function">getElementById</span>(<span class="string">'strokeWidth'</span>).value);</pre>
                </div>

                <p><strong>Step 3:</strong> Use it in the generated script</p>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">JavaScript</span>
                        <button class="code-copy" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><span class="keyword">const</span> script = <span class="string">`
    // ...
    strokeProperty.property("Stroke Width").setValue(</span>${strokeWidth}<span class="string">);
    // ...
`</span>;</pre>
                </div>
            </div>

            <h3>Creating Similar Tools</h3>
            <p>The same architecture works for:</p>
            <ul>
                <li><strong>Color Palette Extractor</strong> ‚Äî Sample colors, output as AE color values</li>
                <li><strong>Grid Template Generator</strong> ‚Äî Input rows/columns, output grid script</li>
                <li><strong>Layer Name Generator</strong> ‚Äî Input naming pattern, output renaming script</li>
            </ul>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon green">üîÑ</div>
                    <div class="card-title">The Universal Pattern</div>
                </div>
                <div class="diagram">1. <span class="highlight">Get input</span> (file, text, numbers)
       ‚Üì
2. <span class="highlight">Process it</span> (analyze, transform, calculate)
       ‚Üì
3. <span class="highlight">Generate output</span> (script string, download file)</div>
            </div>
        </section>

        <!-- Reference Section -->
        <section class="section" id="reference">
            <div class="section-header">
                <span class="section-num">üìã</span>
                <h2>Quick Reference</h2>
            </div>

            <div class="cheat-grid">
                <div class="cheat-card">
                    <h4>HTML Cheat Sheet</h4>
                    <pre><span class="comment">&lt;!-- Container --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">id</span>=<span class="string">"unique"</span> <span class="attr">class</span>=<span class="string">"reusable"</span><span class="tag">&gt;</span>

<span class="comment">&lt;!-- Number input --&gt;</span>
<span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">id</span>=<span class="string">"myInput"</span><span class="tag">&gt;</span>

<span class="comment">&lt;!-- Button --&gt;</span>
<span class="tag">&lt;button</span> <span class="attr">id</span>=<span class="string">"myBtn"</span><span class="tag">&gt;</span>Click<span class="tag">&lt;/button&gt;</span>

<span class="comment">&lt;!-- Image --&gt;</span>
<span class="tag">&lt;img</span> <span class="attr">id</span>=<span class="string">"preview"</span> <span class="attr">src</span>=<span class="string">""</span><span class="tag">&gt;</span>

<span class="comment">&lt;!-- Drawing surface --&gt;</span>
<span class="tag">&lt;canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span><span class="tag">&gt;&lt;/canvas&gt;</span></pre>
                </div>

                <div class="cheat-card">
                    <h4>CSS Cheat Sheet</h4>
                    <pre><span class="function">#id</span> { }       <span class="comment">/* ID selector */</span>
<span class="function">.class</span> { }    <span class="comment">/* Class selector */</span>
<span class="tag">element</span> { }   <span class="comment">/* Element selector */</span>
<span class="function">.a .b</span> { }     <span class="comment">/* .b inside .a */</span>
<span class="function">.a</span><span class="keyword">:hover</span> { }  <span class="comment">/* When hovering */</span>

<span class="property">display</span>: <span class="value">grid</span>;
<span class="property">grid-template-columns</span>: <span class="value">1fr 1fr</span>;
<span class="property">background</span>: <span class="value">#color</span>;
<span class="property">padding</span>: <span class="value">20px</span>;
<span class="property">margin</span>: <span class="value">20px</span>;
<span class="property">border-radius</span>: <span class="value">8px</span>;</pre>
                </div>

                <div class="cheat-card">
                    <h4>JS: DOM Manipulation</h4>
                    <pre><span class="comment">// Get element</span>
<span class="keyword">const</span> el = document.<span class="function">getElementById</span>(<span class="string">'id'</span>);

<span class="comment">// Event listener</span>
el.<span class="function">addEventListener</span>(<span class="string">'click'</span>, () => {});

<span class="comment">// Read input value</span>
<span class="keyword">const</span> val = el.value;

<span class="comment">// Change content</span>
el.textContent = <span class="string">'new text'</span>;

<span class="comment">// Change style</span>
el.style.display = <span class="string">'none'</span>;
el.classList.<span class="function">add</span>(<span class="string">'active'</span>);</pre>
                </div>

                <div class="cheat-card">
                    <h4>JS: Canvas & Files</h4>
                    <pre><span class="comment">// Canvas</span>
<span class="keyword">const</span> ctx = canvas.<span class="function">getContext</span>(<span class="string">'2d'</span>);
ctx.<span class="function">drawImage</span>(img, <span class="number">0</span>, <span class="number">0</span>);
<span class="keyword">const</span> pixels = ctx.<span class="function">getImageData</span>(
    <span class="number">0</span>, <span class="number">0</span>, w, h
).data;

<span class="comment">// Download</span>
<span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="function">Blob</span>([text], 
    {type: <span class="string">'text/plain'</span>});
<span class="keyword">const</span> url = URL.<span class="function">createObjectURL</span>(blob);</pre>
                </div>
            </div>

            <h3>Next Steps</h3>
            <div class="card">
                <ol>
                    <li><strong>Experiment:</strong> Open GridAnalyzer.html, add <code>console.log</code> statements, see what happens</li>
                    <li><strong>Modify:</strong> Try changing the UI colors, adding a new option, adjusting the algorithm</li>
                    <li><strong>Build something new:</strong> Pick a repetitive task in your workflow and apply this pattern</li>
                    <li><strong>Resources:</strong> MDN Web Docs (mozilla.org) ‚Äî Best reference for HTML/CSS/JS</li>
                </ol>
                <div class="callout tip" style="margin-top: 20px; margin-bottom: 0;">
                    <div class="callout-icon">üéØ</div>
                    <div class="callout-content">
                        <div class="callout-title">The Core Skill</div>
                        <p>Breaking the problem into steps and handling each one. You already do this with animation ‚Äî this is the same thinking applied to code.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Copy code functionality
        function copyCode(button) {
            const pre = button.closest('.code-block').querySelector('pre');
            const text = pre.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Collapsible sections
        function toggleCollapsible(header) {
            header.classList.toggle('active');
            const content = header.nextElementSibling;
            content.classList.toggle('show');
        }

        // Progress bar
        window.addEventListener('scroll', () => {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = (scrollTop / docHeight) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        });

        // Active sidebar link
        const sections = document.querySelectorAll('.section');
        const sidebarLinks = document.querySelectorAll('.sidebar-link');

        const observerOptions = {
            root: null,
            rootMargin: '-100px 0px -70% 0px',
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');
                    sidebarLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === '#' + id) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));

        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');

        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Close sidebar when clicking a link on mobile
        sidebarLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 1100) {
                    sidebar.classList.remove('open');
                }
            });
        });
    </script>
</body>
</html>
